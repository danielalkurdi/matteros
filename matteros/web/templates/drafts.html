{% extends "base.html" %}
{% block title %}Drafts{% endblock %}
{% block content %}
<h2>Proactive Drafts</h2>
{% if not drafts %}
<div class="card"><p style="color: var(--muted)">No drafts yet. The daemon creates drafts when it detects new activity.</p></div>
{% else %}
<table>
    <thead>
        <tr><th>Draft ID</th><th>Matter</th><th>Duration</th><th>Status</th><th>Created</th><th>Actions</th></tr>
    </thead>
    <tbody>
        {% for d in drafts %}
        <tr id="draft-{{ d.id }}">
            <td>{{ d.id[:8] }}</td>
            <td>{{ d.entry.get("matter_id", "?") }}</td>
            <td>{{ d.entry.get("duration_minutes", "?") }}m</td>
            <td>
                {% if d.status == "approved" %}<span class="badge badge-green">{{ d.status }}</span>
                {% elif d.status == "rejected" %}<span class="badge badge-red">{{ d.status }}</span>
                {% elif d.status == "pending" %}<span class="badge badge-yellow">{{ d.status }}</span>
                {% else %}<span class="badge badge-blue">{{ d.status }}</span>{% endif %}
            </td>
            <td>{{ d.created_at[:19] }}</td>
            <td>
                {% if d.status == "pending" %}
                <button class="btn btn-green" hx-post="/drafts/{{ d.id }}/approve" hx-target="#draft-{{ d.id }}" hx-swap="delete">Approve</button>
                <button class="btn btn-red" hx-post="/drafts/{{ d.id }}/reject" hx-target="#draft-{{ d.id }}" hx-swap="delete">Reject</button>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endif %}
{% endblock %}
